sudo: required
dist: trusty
language: python
python:
  - "2.7"
  - "3.6"
cache: pip

services:
- mysql

install:
- make install
- export BRANCH=$(if [ "$TRAVIS_PULL_REQUEST" == "false" ]; then echo $TRAVIS_BRANCH; else echo $TRAVIS_PULL_REQUEST_BRANCH; fi)
- export DEFAULT_BRANCH=modular-models-epic
- echo $TRAVIS_BRANCH
- echo $TRAVIS_PULL_REQUEST_BRANCH
- echo $TRAVIS_PULL_REQUEST
- echo $BRANCH
- export CURRENT_HEAD=$(git rev-parse HEAD)
- git checkout -b $DEFAULT_BRANCH || git checkout $DEFAULT_BRANCH
- git pull origin $DEFAULT_BRANCH
- git checkout -b $BRANCH || git checkout $BRANCH
- git pull origin $BRANCH
- git checkout $CURRENT_HEAD

script:
- make test
- make code-check
